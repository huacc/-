# 心理分析系统 - P0阶段交互需求设计 v2.0

> **版本**: v2.0
> **文档类型**: 前端交互需求设计文档
> **创建日期**: 2026-02-08
> **状态**: Draft
> **对应PRD**: 心理分析系统_产品需求文档_v2.0.md
> **对应元本体文档**: 元本体数据模型需求文档_v1.0.md

---

## 文档说明

本文档是心理分析系统**P0阶段（基础设施构建）**的前端交互需求设计文档，基于PRD v2.0和元本体数据模型需求文档v1.0编写。

**P0阶段定位**：构建通用的心理学本体和知识库，让领域专家可以用起来

**P0核心功能**：
- P0-1: 模型管理与调度
- P0-2: 提示词管理系统
- P0-3: 元本体体系
- P0-4: 知识图谱与语义查询

**重要说明**：
- 本文档聚焦于P0阶段的前端交互设计，不涉及P1阶段的分析引擎、场景模板、报告生成等功能
- 本文档是实际落地版本，不是演示Demo
- 设计参考：Neo4j Bloom（图可视化）、Apifox（工具栏设计）、现有Demo布局

---

## 目录

1. [产品定位与核心用户](#1-产品定位与核心用户)
2. [整体架构设计](#2-整体架构设计)
3. [核心功能模块详细设计](#3-核心功能模块详细设计)
   - 3.1 元本体管理
   - 3.2 知识图谱构建
   - 3.3 提示词管理
   - 3.4 模型管理
4. [交互规范](#4-交互规范)
5. [视觉规范](#5-视觉规范)
6. [技术实现建议](#6-技术实现建议)

---

## 1. 产品定位与核心用户

### 1.1 P0阶段产品定位

**本体与知识库构建平台**

P0阶段的核心目标是为领域专家提供一套专业的工具，用于构建心理学领域的本体模型和知识图谱。这是整个心理分析系统的基础设施层。

### 1.2 核心用户

| 用户角色 | 核心诉求 | 使用场景 |
|---------|---------|---------|
| **心理学专家** | 构建心理学领域本体，定义心理特征维度和诊断规则 | 本体建模、知识录入 |
| **领域专家** | 基于元本体框架构建特定场景的心理模型 | 场景本体定制、知识扩展 |
| **系统管理员** | 管理模型配置、提示词模板、用户权限 | 系统配置、资源管理 |

### 1.3 P0核心功能表

| 功能模块 | PRD编号 | 核心能力 | 优先级 |
|---------|---------|---------|--------|
| **模型管理与调度** | 3.7 | 多模型提供商支持、模型配置、智能调度、性能监控 | P0-1 |
| **提示词管理系统** | 3.2 | 提示词模板管理、版本管理、本体/知识集成 | P0-2 |
| **元本体体系** | 3.4 | 元本体框架、心理模型构建、本体验证 | P0-3 |
| **知识图谱与语义查询** | 3.6 | 知识图谱构建、Cypher查询、智能查询生成、RAG机制 | P0-4 |

### 1.4 设计原则

1. **专业工具化**：面向专家用户，提供专业级的建模和管理工具
2. **可视化优先**：本体和知识图谱采用图形化展示，降低理解门槛
3. **AI辅助增强**：提供AI辅助工具，提升建模和知识录入效率
4. **版本可追溯**：所有本体和知识变更都有版本记录，支持回溯
5. **参考业界最佳实践**：借鉴Neo4j Bloom、Apifox等成熟产品的交互模式

---

## 2. 整体架构设计

### 2.1 系统布局

采用**左侧导航 + 主工作区**的经典布局模式（参考现有Demo的AdminLayout）：

```
┌─────────────────────────────────────────────────────────────────┐
│                        顶部Header（可选）                         │
├──────────┬──────────────────────────────────────────────────────┤
│          │                                                      │
│          │                                                      │
│   左侧   │                  主工作区                             │
│  导航栏  │              （根据选中模块动态切换）                  │
│  240px   │                                                      │
│          │                                                      │
│          │                                                      │
│          │                                                      │
└──────────┴──────────────────────────────────────────────────────┘
```

**布局规格**：
- 左侧导航栏：固定宽度240px，深色主题（#001529）
- 主工作区：自适应宽度，浅色背景（#fff）
- 最小支持分辨率：1200px × 768px

### 2.2 导航菜单配置

左侧导航菜单包含4个核心模块：

| 菜单项 | 图标 | 路由 | 对应PRD |
|-------|------|------|---------|
| **元本体管理** | DeploymentUnitOutlined | /ontology | 3.4 |
| **知识图谱构建** | DatabaseOutlined | /knowledge | 3.6 |
| **提示词管理** | FileTextOutlined | /prompt | 3.2 |
| **模型管理** | ApiOutlined | /model | 3.7 |

**导航交互**：
- 点击菜单项切换到对应模块
- 当前选中项高亮显示
- 支持面包屑导航（顶部Header）

### 2.3 页面路由结构

```
/
  ├── /ontology            # 元本体管理
  │   ├── /list            # 本体列表（默认）
  │   ├── /edit/:id        # 编辑本体
  │   └── /graph           # 本体关系图
  │
  ├── /knowledge           # 知识图谱构建
  │   ├── /canvas          # 知识图谱画布（默认）
  │   └── /import          # 知识导入
  │
  ├── /prompt              # 提示词管理
  │   ├── /list            # 提示词列表（默认）
  │   ├── /edit/:id        # 编辑提示词
  │   └── /test            # 提示词测试
  │
  └── /model               # 模型管理
      ├── /list            # 模型列表（默认）
      ├── /config/:id      # 模型配置
      └── /monitor         # 性能监控
```

### 2.4 响应式设计

**P0阶段优先支持桌面端**：
- 主要支持分辨率：≥ 1200px
- 移动端适配：P1阶段考虑

---

## 3. 核心功能模块详细设计

### 3.1 元本体管理

#### 3.1.1 功能概述

**对应PRD**: 3.4 元本体体系（P0-3）

**核心能力**：
- 元本体框架展示
- 本体定义的结构化编辑
- 本体关系图可视化
- 本体分类管理
- 本体版本管理
- 孤立本体检查

#### 3.1.2 界面布局

采用**Tab切换模式**，提供两种视图：

```
┌─────────────────────────────────────────────────────────────────┐
│  元本体管理                                    [+ 新建本体] [导入] │
├─────────────────────────────────────────────────────────────────┤
│  [Tab1: 本体定义] [Tab2: 本体关系图]                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                    Tab内容区域                                   │
│                  （根据选中Tab动态切换）                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.1.3 Tab1: 本体定义（结构化编辑）

**布局结构**：

```
┌──────────┬──────────────────────────────────────────────────────┐
│          │  本体详情                                             │
│  本体    │  ┌─────────────────────────────────────────────────┐ │
│  分类树  │  │ 基本信息                                         │ │
│          │  │ • 本体名称: [输入框]                             │ │
│  □ 全部  │  │ • 本体类型: [下拉选择] Entity/Event/State/...   │ │
│  ├ 实体  │  │ • 所属分类: [级联选择]                           │ │
│  ├ 事件  │  │ • 描述: [文本域]                                 │ │
│  ├ 状态  │  └─────────────────────────────────────────────────┘ │
│  ├ 可观察│  ┌─────────────────────────────────────────────────┐ │
│  ├ 规则  │  │ 属性定义                          [+ 添加属性]   │ │
│  └ 模型  │  │ ┌─────┬────────┬────────┬────────┬──────────┐  │ │
│          │  │ │属性名│ 数据类型│ 是否必填│ 默认值 │ 操作     │  │ │
│  [搜索]  │  │ ├─────┼────────┼────────┼────────┼──────────┤  │ │
│          │  │ │name │ String │   ✓    │   -    │ [编辑删除]│  │ │
│          │  │ └─────┴────────┴────────┴────────┴──────────┘  │ │
│          │  └─────────────────────────────────────────────────┘ │
│          │  ┌─────────────────────────────────────────────────┐ │
│          │  │ 关系定义                          [+ 添加关系]   │ │
│          │  │ ┌────────┬────────┬────────┬────────┬────────┐ │ │
│          │  │ │关系类型│ 目标本体│ 基数   │ 描述   │ 操作   │ │ │
│          │  │ ├────────┼────────┼────────┼────────┼────────┤ │ │
│          │  │ │has_part│ Entity │ 1:N    │ 包含关系│[编辑删除]││ │
│          │  │ └────────┴────────┴────────┴────────┴────────┘ │ │
│          │  └─────────────────────────────────────────────────┘ │
│          │                                                      │
│          │  [保存] [取消] [删除本体]                             │
└──────────┴──────────────────────────────────────────────────────┘
```

**交互说明**：

1. **左侧分类树**：
   - 显示本体的分类层级结构
   - 点击分类节点，右侧显示该分类下的本体列表
   - 支持拖拽调整分类层级
   - 支持搜索过滤

2. **右侧本体详情**：
   - 基本信息：本体名称、类型、分类、描述
   - 属性定义：表格形式展示，支持增删改
   - 关系定义：表格形式展示，支持增删改
   - 操作按钮：保存、取消、删除

3. **数据验证**：
   - 本体名称不能为空
   - 本体类型必须选择
   - 属性名称不能重复
   - 关系目标本体必须存在

#### 3.1.4 Tab2: 本体关系图（可视化）

**布局结构**：

```
┌─────────────────────────────────────────────────────────────────┐
│  工具栏: [选择] [拖拽] [缩放] [适应画布] [导出图片] [全屏]        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                      图形画布区域                                │
│                   （Neo4j Bloom风格）                            │
│                                                                 │
│    ┌─────────┐                                                 │
│    │ Entity  │──has_part──┐                                    │
│    └─────────┘            │                                    │
│         │                 ▼                                    │
│      is_a            ┌─────────┐                               │
│         │            │ Entity  │                               │
│         ▼            └─────────┘                               │
│    ┌─────────┐                                                 │
│    │Observable│                                                │
│    └─────────┘                                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **图形展示**：
   - 节点：圆角矩形，显示本体名称和类型
   - 边：箭头连线，显示关系类型
   - 颜色编码：不同本体类型使用不同颜色
   - 参考Neo4j Bloom的视觉风格

2. **交互操作**：
   - 拖拽节点调整位置
   - 点击节点查看详情（右侧弹出抽屉）
   - 双击节点进入编辑模式
   - 滚轮缩放画布
   - 框选多个节点进行批量操作

3. **工具栏功能**：
   - 选择模式：点击选中节点
   - 拖拽模式：拖拽调整布局
   - 缩放控制：放大/缩小/适应画布
   - 导出图片：PNG/SVG格式
   - 全屏模式：专注于图形编辑

4. **布局算法**：
   - 自动布局：力导向布局（Force-Directed）
   - 手动布局：用户拖拽调整
   - 保存布局：记录节点位置

#### 3.1.5 版本管理

**设计方案**：采用**分层版本管理**（本体层 + 知识库层）

**版本管理界面**：

```
┌─────────────────────────────────────────────────────────────────┐
│  版本历史                                        [创建新版本]     │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ 本体层版本                                                   ││
│  │ ┌──────┬──────────┬──────────┬──────────┬────────────────┐ ││
│  │ │版本号│ 创建时间  │ 创建人   │ 变更说明 │ 操作           │ ││
│  │ ├──────┼──────────┼──────────┼──────────┼────────────────┤ ││
│  │ │v1.2  │2026-02-08│ 张三     │新增情绪本体│[查看][回滚][对比]│ ││
│  │ │v1.1  │2026-02-07│ 李四     │修改关系定义│[查看][回滚][对比]│ ││
│  │ └──────┴──────────┴──────────┴──────────┴────────────────┘ ││
│  └─────────────────────────────────────────────────────────────┘│
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ 知识库层版本                                                 ││
│  │ ┌──────┬──────────┬──────────┬──────────┬────────────────┐ ││
│  │ │版本号│ 创建时间  │ 创建人   │ 变更说明 │ 操作           │ ││
│  │ ├──────┼──────────┼──────────┼──────────┼────────────────┤ ││
│  │ │v2.1  │2026-02-08│ 王五     │导入新知识 │[查看][回滚][对比]│ ││
│  │ └──────┴──────────┴──────────┴──────────┴────────────────┘ ││
│  └─────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **版本创建**：
   - 手动创建：点击"创建新版本"按钮，填写变更说明
   - 自动创建：重大变更时自动创建版本快照

2. **版本对比**：
   - 选择两个版本进行对比
   - 高亮显示差异部分（新增、修改、删除）
   - 支持导出对比报告

3. **版本回滚**：
   - 点击"回滚"按钮，确认后恢复到指定版本
   - 回滚操作会创建新版本，保留历史记录

4. **影响分析**：
   - 显示哪些产品/场景使用了该本体
   - 评估变更的影响范围
   - 提供变更风险提示

#### 3.1.6 孤立本体检查

**功能说明**：检测没有任何关系连接的本体节点

**检查界面**：

```
┌─────────────────────────────────────────────────────────────────┐
│  孤立本体检查                                    [执行检查]       │
├─────────────────────────────────────────────────────────────────┤
│  检查结果: 发现 3 个孤立本体                                     │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ⚠️ 情绪_焦虑                                                 ││
│  │    类型: State | 创建时间: 2026-02-01                        ││
│  │    问题: 没有任何关系连接                                     ││
│  │    建议: 添加与"情绪"的is_a关系                              ││
│  │    [查看详情] [添加关系] [忽略]                               ││
│  └─────────────────────────────────────────────────────────────┘│
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ⚠️ 行为_回避                                                 ││
│  │    类型: Observable | 创建时间: 2026-01-28                   ││
│  │    问题: 没有任何关系连接                                     ││
│  │    建议: 添加与"行为"的is_a关系                              ││
│  │    [查看详情] [添加关系] [忽略]                               ││
│  └─────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────┘
```

**交互说明**：
- 点击"执行检查"按钮，系统自动扫描所有本体
- 列出所有孤立本体，显示详细信息
- 提供快速修复建议
- 支持批量处理

---

### 3.2 知识图谱构建

#### 3.2.1 功能概述

**对应PRD**: 3.6 知识图谱与语义查询（P0-4）

**核心能力**：
- 知识图谱可视化画布
- 低代码知识构建
- AI辅助知识生成
- Cypher查询能力
- 知识导入导出

#### 3.2.2 界面布局

采用**左侧画布（70-80%）+ 右侧工具栏（20-30%）**的布局：

```
┌─────────────────────────────────────────────────────────────────┐
│  知识图谱构建                                                     │
├──────────────────────────────────────┬──────────────────────────┤
│                                      │                          │
│                                      │   右侧工具栏             │
│          知识图谱画布                 │   （Tab切换）            │
│        （Neo4j Bloom风格）            │                          │
│                                      │  [Tab1: 节点工具]        │
│                                      │  [Tab2: 关系工具]        │
│                                      │  [Tab3: AI助手]          │
│                                      │  [Tab4: 查询工具]        │
│                                      │                          │
│                                      │  ┌────────────────────┐ │
│                                      │  │                    │ │
│                                      │  │   Tab内容区域      │ │
│                                      │  │                    │ │
│                                      │  └────────────────────┘ │
│                                      │                          │
└──────────────────────────────────────┴──────────────────────────┘
```

**布局规格**：
- 左侧画布：70-80%宽度，全高
- 右侧工具栏：20-30%宽度，全高
- 工具栏采用Tab切换，避免内容过多

#### 3.2.3 左侧画布区域

**画布功能**：

```
┌─────────────────────────────────────────────────────────────┐
│ 工具栏: [选择][手绘(P1)][缩放][适应][导出][全屏][Cypher查询] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│              知识图谱可视化区域                              │
│                                                             │
│    ┌─────────┐                                             │
│    │ 张三    │──has_emotion──┐                             │
│    │ Person  │               │                             │
│    └─────────┘               ▼                             │
│         │              ┌─────────┐                         │
│    has_behavior        │  焦虑   │                         │
│         │              │ Emotion │                         │
│         ▼              └─────────┘                         │
│    ┌─────────┐                                             │
│    │  回避   │                                             │
│    │Behavior │                                             │
│    └─────────┘                                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **节点展示**：
   - 节点形状：圆角矩形
   - 节点内容：显示实例名称和本体类型
   - 颜色编码：根据本体类型自动着色
   - 节点大小：根据连接数量动态调整

2. **关系展示**：
   - 关系线：带箭头的曲线
   - 关系标签：显示关系类型
   - 关系权重：线条粗细表示权重

3. **交互操作**：
   - 单击节点：选中并在右侧显示详情
   - 双击节点：展开相关节点
   - 拖拽节点：调整位置
   - 右键菜单：编辑、删除、展开、收起
   - 框选：批量选择节点

4. **工具栏功能**：
   - 选择模式：点击选中
   - 手绘模式：手动创建节点和关系（P1阶段实现，P0阶段按钮置灰）
   - 缩放控制：放大/缩小/适应画布
   - 导出：PNG/SVG/JSON格式
   - 全屏：专注模式
   - Cypher查询：打开查询面板

#### 3.2.4 右侧工具栏 - Tab1: 节点工具

**功能说明**：创建和编辑知识节点

```
┌────────────────────────────────────┐
│ [Tab1: 节点工具]                   │
├────────────────────────────────────┤
│                                    │
│ 创建节点                            │
│ ┌────────────────────────────────┐ │
│ │ 选择本体类型:                   │ │
│ │ [下拉选择] Person/Emotion/...  │ │
│ │                                │ │
│ │ 节点属性:                       │ │
│ │ • 名称: [输入框]               │ │
│ │ • 描述: [文本域]               │ │
│ │ • 其他属性...                  │ │
│ │                                │ │
│ │ [创建节点]                      │ │
│ └────────────────────────────────┘ │
│                                    │
│ 当前选中节点                        │
│ ┌────────────────────────────────┐ │
│ │ 张三 (Person)                  │ │
│ │ ─────────────────────────────  │ │
│ │ • ID: node_001                 │ │
│ │ • 名称: 张三                    │ │
│ │ • 年龄: 35                      │ │
│ │ • 性别: 男                      │ │
│ │                                │ │
│ │ [编辑] [删除] [展开关系]        │ │
│ └────────────────────────────────┘ │
│                                    │
└────────────────────────────────────┘
```

**交互说明**：
- 选择本体类型后，自动加载该本体定义的属性字段
- 填写属性值，点击"创建节点"按钮
- 新节点自动添加到画布中心
- 选中画布中的节点，右侧显示节点详情
- 支持直接编辑节点属性

#### 3.2.5 右侧工具栏 - Tab2: 关系工具

**功能说明**：创建和编辑节点之间的关系

```
┌────────────────────────────────────┐
│ [Tab2: 关系工具]                   │
├────────────────────────────────────┤
│                                    │
│ 创建关系                            │
│ ┌────────────────────────────────┐ │
│ │ 源节点: [已选择] 张三           │ │
│ │ 目标节点: [点击画布选择]        │ │
│ │                                │ │
│ │ 关系类型:                       │ │
│ │ [下拉选择] has_emotion/...     │ │
│ │                                │ │
│ │ 关系属性:                       │ │
│ │ • 强度: [滑块] 0.8             │ │
│ │ • 时间: [日期选择]             │ │
│ │ • 备注: [文本域]               │ │
│ │                                │ │
│ │ [创建关系]                      │ │
│ └────────────────────────────────┘ │
│                                    │
│ 当前选中关系                        │
│ ┌────────────────────────────────┐ │
│ │ 张三 → 焦虑                     │ │
│ │ has_emotion                    │ │
│ │ ─────────────────────────────  │ │
│ │ • 强度: 0.8                     │ │
│ │ • 时间: 2026-02-08             │ │
│ │                                │ │
│ │ [编辑] [删除] [反转方向]        │ │
│ └────────────────────────────────┘ │
│                                    │
└────────────────────────────────────┘
```

**交互说明**：
- 先在画布中选择源节点
- 再点击目标节点,自动填充到表单
- 选择关系类型，填写关系属性
- 点击"创建关系"按钮，画布中显示新关系
- 点击画布中的关系线，右侧显示关系详情

#### 3.2.6 右侧工具栏 - Tab3: AI助手

**功能说明**：AI辅助知识生成，支持两种模式

```
┌────────────────────────────────────┐
│ [Tab3: AI助手]                     │
├────────────────────────────────────┤
│                                    │
│ AI生成模式                          │
│ ┌────────────────────────────────┐ │
│ │ ○ 基于本体生成                  │ │
│ │ ● 从文档提取                    │ │
│ └────────────────────────────────┘ │
│                                    │
│ 模式1: 基于本体生成                 │
│ ┌────────────────────────────────┐ │
│ │ 选择本体: [下拉] Person        │ │
│ │ 生成数量: [数字] 10            │ │
│ │ 生成策略:                       │ │
│ │ □ 包含关系                      │ │
│ │ □ 随机属性值                    │ │
│ │                                │ │
│ │ [开始生成]                      │ │
│ └────────────────────────────────┘ │
│                                    │
│ 模式2: 从文档提取                   │
│ ┌────────────────────────────────┐ │
│ │ 上传文档:                       │ │
│ │ [选择文件] 或 拖拽到此处        │ │
│ │                                │ │
│ │ 提取目标:                       │ │
│ │ ☑ 人物信息                      │ │
│ │ ☑ 情绪状态                      │ │
│ │ ☑ 行为表现                      │ │
│ │ □ 事件记录                      │ │
│ │                                │ │
│ │ [开始提取]                      │ │
│ └────────────────────────────────┘ │
│                                    │
│ 生成结果预览                        │
│ ┌────────────────────────────────┐ │
│ │ 已生成 5 个节点, 8 个关系       │ │
│ │ [预览] [应用到画布] [取消]      │ │
│ └────────────────────────────────┘ │
│                                    │
└────────────────────────────────────┘
```

**交互说明**：

1. **模式1: 基于本体生成**：
   - 选择要生成的本体类型
   - 设置生成数量和策略
   - AI根据本体定义生成符合规范的知识实例
   - 生成结果先预览，确认后应用到画布

2. **模式2: 从文档提取**：
   - 上传PDF/Word/文本文档
   - 选择要提取的知识类型
   - AI自动识别文档中的实体和关系
   - 提取结果先预览，确认后应用到画布

3. **预览与确认**：
   - 显示生成/提取的节点和关系数量
   - 点击"预览"查看详细内容
   - 点击"应用到画布"将结果添加到知识图谱
   - 支持编辑后再应用

#### 3.2.7 右侧工具栏 - Tab4: 查询工具

**功能说明**：Cypher查询和智能查询生成

```
┌────────────────────────────────────┐
│ [Tab4: 查询工具]                   │
├────────────────────────────────────┤
│                                    │
│ 查询模式                            │
│ ┌────────────────────────────────┐ │
│ │ ○ 自然语言查询                  │ │
│ │ ● Cypher查询                   │ │
│ └────────────────────────────────┘ │
│                                    │
│ 自然语言查询                        │
│ ┌────────────────────────────────┐ │
│ │ 输入查询:                       │ │
│ │ [文本框]                        │ │
│ │ "查找所有焦虑情绪的人"          │ │
│ │                                │ │
│ │ [查询] [清空]                   │ │
│ └────────────────────────────────┘ │
│                                    │
│ Cypher查询                         │
│ ┌────────────────────────────────┐ │
│ │ [代码编辑器]                    │ │
│ │ MATCH (p:Person)-[:has_emotion]│ │
│ │   ->(e:Emotion {name:'焦虑'})  │ │
│ │ RETURN p                       │ │
│ │                                │ │
│ │ [执行] [格式化] [保存]          │ │
│ └────────────────────────────────┘ │
│                                    │
│ 查询结果                            │
│ ┌────────────────────────────────┐ │
│ │ 找到 3 条结果                   │ │
│ │ ┌────────────────────────────┐ │ │
│ │ │ 张三 (Person)              │ │ │
│ │ │ 李四 (Person)              │ │ │
│ │ │ 王五 (Person)              │ │ │
│ │ └────────────────────────────┘ │ │
│ │                                │ │
│ │ [在画布中高亮] [导出结果]       │ │
│ └────────────────────────────────┘ │
│                                    │
│ 常用查询模板                        │
│ ┌────────────────────────────────┐ │
│ │ • 查找孤立节点                  │ │
│ │ • 查找最短路径                  │ │
│ │ • 查找相似节点                  │ │
│ │ [更多模板...]                   │ │
│ └────────────────────────────────┘ │
│                                    │
└────────────────────────────────────┘
```

**交互说明**：

1. **自然语言查询**：
   - 用户输入自然语言描述
   - AI理解意图并生成Cypher查询
   - 自动执行查询并返回结果
   - 支持fallback到静态查询模板

2. **Cypher查询**：
   - 提供代码编辑器，支持语法高亮
   - 支持代码格式化和自动补全
   - 点击"执行"运行查询
   - 支持保存常用查询

3. **查询结果展示**：
   - 列表形式显示查询结果
   - 点击结果项在画布中高亮显示
   - 支持导出为JSON/CSV格式

4. **查询模板**：
   - 提供常用查询模板
   - 点击模板自动填充到编辑器
   - 用户可自定义模板

#### 3.2.8 知识导入导出

**功能说明**：批量导入导出知识数据

**导入界面**：
- 支持格式：JSON、CSV、Neo4j Dump
- 上传文件后预览数据结构
- 映射字段到本体定义
- 验证数据完整性后导入

**导出界面**：
- 选择导出范围：全部/选中节点/查询结果
- 选择导出格式：JSON/CSV/Neo4j Dump
- 配置导出选项：包含关系/仅节点
- 下载导出文件

---

### 3.3 提示词管理

#### 3.3.1 功能概述

**对应PRD**: 3.2 提示词管理系统（P0-2）

**核心能力**：
- 提示词模板管理（CRUD）
- 提示词分类组织
- 版本管理
- 本体/知识集成
- 提示词测试

#### 3.3.2 界面布局

采用**三栏布局**：左侧分类树 + 中间编辑器 + 右侧测试面板

```
┌──────────┬────────────────────────────┬──────────────────────┐
│          │                            │                      │
│  分类树  │      提示词编辑器           │    测试面板          │
│  20%     │         50%                │      30%             │
│          │                            │                      │
│          │                            │                      │
│          │                            │                      │
│          │                            │                      │
│          │                            │                      │
└──────────┴────────────────────────────┴──────────────────────┘
```

#### 3.3.3 左侧分类树

**功能说明**：提示词的分类组织和导航

```
┌────────────────────────────┐
│ 提示词分类      [+ 新建分类]│
├────────────────────────────┤
│ 🔍 [搜索框]                │
│                            │
│ □ 全部提示词 (128)         │
│ ├ 📁 本体构建 (45)         │
│ │  ├ 实体定义 (20)         │
│ │  ├ 关系定义 (15)         │
│ │  └ 规则定义 (10)         │
│ ├ 📁 知识提取 (38)         │
│ │  ├ 文档解析 (18)         │
│ │  └ 实体识别 (20)         │
│ ├ 📁 分析场景 (25)         │
│ │  ├ 审讯分析 (10)         │
│ │  └ 人才评估 (15)         │
│ └ 📁 报告生成 (20)         │
│                            │
│ ⭐ 我的收藏 (8)            │
│ 🕐 最近使用 (12)           │
│                            │
└────────────────────────────┘
```

**交互说明**：
- 点击分类展开/收起子分类
- 点击提示词名称，中间编辑器加载内容
- 支持拖拽调整分类层级
- 右键菜单：重命名、删除、新建子分类
- 搜索框支持模糊搜索

#### 3.3.4 中间编辑器

**功能说明**：提示词的编辑和配置

```
┌──────────────────────────────────────────────────────────┐
│ 提示词名称: [输入框] 实体定义生成器                       │
│ 所属分类: [级联选择] 本体构建 > 实体定义                  │
│ 标签: [标签输入] #本体 #实体 #AI生成                      │
├──────────────────────────────────────────────────────────┤
│ [Tab1: 提示词内容] [Tab2: 变量配置] [Tab3: 版本历史]     │
├──────────────────────────────────────────────────────────┤
│                                                          │
│ [代码编辑器 - Markdown格式]                               │
│                                                          │
│ # 任务描述                                                │
│ 你是一个心理学本体建模专家，请根据以下信息生成实体定义。   │
│                                                          │
│ ## 输入信息                                               │
│ - 实体名称: {{entity_name}}                              │
│ - 实体描述: {{entity_description}}                       │
│ - 参考本体: {{reference_ontology}}                       │
│                                                          │
│ ## 输出要求                                               │
│ 请以JSON格式输出实体定义，包含以下字段：                   │
│ - name: 实体名称                                          │
│ - type: 实体类型                                          │
│ - properties: 属性列表                                    │
│ - relationships: 关系列表                                 │
│                                                          │
│ ## 示例                                                   │
│ ```json                                                  │
│ {                                                        │
│   "name": "情绪",                                        │
│   "type": "State",                                       │
│   ...                                                    │
│ }                                                        │
│ ```                                                      │
│                                                          │
├──────────────────────────────────────────────────────────┤
│ 字数统计: 256字 | Token估算: ~380 tokens                  │
│                                                          │
│ [保存] [另存为] [删除] [导出]                             │
└──────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **基本信息编辑**：
   - 提示词名称：必填，唯一标识
   - 所属分类：级联选择，支持多级分类
   - 标签：多标签输入，便于搜索和分类

2. **Tab1: 提示词内容**：
   - 代码编辑器，支持Markdown语法高亮
   - 支持变量占位符：{{variable_name}}
   - 实时显示字数和Token估算
   - 支持代码格式化

3. **Tab2: 变量配置**：
   - 列出所有变量及其说明
   - 配置变量类型和默认值
   - 配置变量来源（用户输入/本体引用/知识检索）

4. **Tab3: 版本历史**：
   - 显示所有历史版本
   - 支持版本对比和回滚
   - 显示版本状态（草稿/测试/生产）

#### 3.3.5 右侧测试面板

**功能说明**：实时测试提示词效果

```
┌────────────────────────────────────┐
│ 提示词测试                          │
├────────────────────────────────────┤
│                                    │
│ 模型选择                            │
│ [下拉选择] GPT-4o                  │
│                                    │
│ 变量输入                            │
│ ┌────────────────────────────────┐ │
│ │ entity_name:                   │ │
│ │ [输入框] 情绪                   │ │
│ │                                │ │
│ │ entity_description:            │ │
│ │ [文本域] 人的心理状态...        │ │
│ │                                │ │
│ │ reference_ontology:            │ │
│ │ [选择器] State                 │ │
│ └────────────────────────────────┘ │
│                                    │
│ 参数配置                            │
│ ┌────────────────────────────────┐ │
│ │ Temperature: [滑块] 0.7        │ │
│ │ Max Tokens: [输入] 2000        │ │
│ │ Top P: [滑块] 0.9              │ │
│ └────────────────────────────────┘ │
│                                    │
│ [执行测试] [清空结果]               │
│                                    │
│ 测试结果                            │
│ ┌────────────────────────────────┐ │
│ │ [结果展示区 - 可折叠]           │ │
│ │                                │ │
│ │ {                              │ │
│ │   "name": "情绪",              │ │
│ │   "type": "State",             │ │
│ │   "properties": [...]          │ │
│ │ }                              │ │
│ │                                │ │
│ │ Token消耗: 380                 │ │
│ │ 响应时间: 2.3s                 │ │
│ │ 成本: $0.0076                  │ │
│ └────────────────────────────────┘ │
│                                    │
│ [保存测试记录] [应用到本体]         │
│                                    │
└────────────────────────────────────┘
```

<thinking>
The user wants me to continue outputting content in segments. I've added the right test panel for the prompt management section. Now I should continue with Section 3.4 Model Management. Let me add that section next.
</thinking>

**交互说明**：

1. **模型选择**：
   - 从已配置的模型列表中选择
   - 显示模型的基本信息（提供商、版本）

2. **变量输入**：
   - 根据提示词中的变量自动生成输入表单
   - 支持文本输入、下拉选择、本体选择器等
   - 变量值实时注入到提示词中

3. **参数配置**：
   - Temperature：控制输出随机性
   - Max Tokens：限制输出长度
   - Top P：核采样参数
   - 其他模型特定参数

4. **执行测试**：
   - 点击"执行测试"按钮，调用LLM
   - 显示实时响应结果
   - 统计Token消耗、响应时间、成本

5. **结果处理**：
   - 保存测试记录到历史
   - 如果结果是本体定义，可直接应用到本体管理模块

---

### 3.4 模型管理

#### 3.4.1 功能概述

**对应PRD**: 3.7 模型管理与调度（P0-1）

**核心能力**：
- 多模型提供商支持（12+种LLM，3+种VLM）
- 模型配置管理
- 智能模型调度
- 性能监控

#### 3.4.2 界面布局

采用**Tab切换模式**，提供三个视图：

```
┌─────────────────────────────────────────────────────────────────┐
│  模型管理                                        [+ 添加模型]     │
├─────────────────────────────────────────────────────────────────┤
│  [Tab1: 模型列表] [Tab2: 调度策略] [Tab3: 性能监控]             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│                    Tab内容区域                                   │
│                  （根据选中Tab动态切换）                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.4.3 Tab1: 模型列表

**功能说明**：管理所有已配置的模型

```
┌─────────────────────────────────────────────────────────────────┐
│ 筛选: [全部] [LLM] [VLM]    搜索: [输入框]                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ OpenAI GPT-4o                                    [启用] ✓   │ │
│ │ ─────────────────────────────────────────────────────────── │ │
│ │ 提供商: OpenAI | 类型: LLM | 版本: gpt-4o-2024-05-13        │ │
│ │ 状态: 🟢 正常 | 成功率: 99.2% | 平均响应: 2.3s              │ │
│ │ 成本: $0.005/1K tokens (input) | $0.015/1K tokens (output) │ │
│ │                                                             │ │
│ │ [编辑配置] [测试连接] [查看详情] [禁用]                      │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ Anthropic Claude 3.5 Sonnet                      [启用] ✓   │ │
│ │ ─────────────────────────────────────────────────────────── │ │
│ │ 提供商: Anthropic | 类型: LLM | 版本: claude-3-5-sonnet    │ │
│ │ 状态: 🟢 正常 | 成功率: 98.8% | 平均响应: 1.8s              │ │
│ │ 成本: $0.003/1K tokens (input) | $0.015/1K tokens (output) │ │
│ │                                                             │ │
│ │ [编辑配置] [测试连接] [查看详情] [禁用]                      │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ Google Gemini 2.0 Flash                          [启用] ✓   │ │
│ │ ─────────────────────────────────────────────────────────── │ │
│ │ 提供商: Google | 类型: VLM | 版本: gemini-2.0-flash        │ │
│ │ 状态: 🟡 限流中 | 成功率: 95.5% | 平均响应: 3.1s            │ │
│ │ 成本: $0.001/1K tokens (input) | $0.005/1K tokens (output) │ │
│ │                                                             │ │
│ │ [编辑配置] [测试连接] [查看详情] [禁用]                      │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **模型卡片**：
   - 显示模型名称、提供商、类型、版本
   - 实时状态：正常🟢、限流🟡、异常🔴
   - 关键指标：成功率、平均响应时间、成本
   - 启用/禁用开关

2. **操作按钮**：
   - 编辑配置：打开配置对话框
   - 测试连接：验证API密钥和端点
   - 查看详情：查看完整配置和历史记录
   - 禁用：暂停使用该模型

3. **添加模型**：
   - 点击"+ 添加模型"按钮
   - 选择提供商（OpenAI、Anthropic、Google等）
   - 填写API密钥和端点地址
   - 配置默认参数和使用限制

**模型配置对话框**：

```
┌─────────────────────────────────────────────────────────────┐
│ 编辑模型配置 - GPT-4o                              [×]       │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 基本信息                                                     │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 模型名称: [输入框] GPT-4o                               │ │
│ │ 提供商: [下拉] OpenAI                                   │ │
│ │ 模型ID: [输入框] gpt-4o-2024-05-13                      │ │
│ │ API密钥: [密码框] sk-***************************        │ │
│ │ 端点地址: [输入框] https://api.openai.com/v1           │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 默认参数                                                     │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ Temperature: [滑块] 0.7                                 │ │
│ │ Max Tokens: [输入框] 4096                               │ │
│ │ Top P: [滑块] 0.9                                       │ │
│ │ Frequency Penalty: [滑块] 0.0                           │ │
│ │ Presence Penalty: [滑块] 0.0                            │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 使用限制                                                     │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 每分钟请求数: [输入框] 60                               │ │
│ │ 每天请求数: [输入框] 10000                              │ │
│ │ 单次最大Token: [输入框] 8192                            │ │
│ │ 超时时间(秒): [输入框] 60                               │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [测试连接] [保存] [取消]                                     │
└─────────────────────────────────────────────────────────────┘
```

#### 3.4.4 Tab2: 调度策略

**功能说明**：配置智能模型调度规则

```
┌─────────────────────────────────────────────────────────────────┐
│ 调度策略配置                                                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ 默认调度策略                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ○ 质量优先 - 优先选择效果最好的模型                          │ │
│ │ ● 平衡选择 - 综合考虑质量、速度、成本                        │ │
│ │ ○ 速度优先 - 优先选择响应最快的模型                          │ │
│ │ ○ 成本优先 - 优先选择成本最低的模型                          │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ 任务类型映射                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ┌──────────────┬──────────────┬──────────────┬────────────┐ │ │
│ │ │ 任务类型     │ 首选模型     │ 备用模型     │ 操作       │ │ │
│ │ ├──────────────┼──────────────┼──────────────┼────────────┤ │ │
│ │ │ 本体构建     │ GPT-4o       │ Claude 3.5   │ [编辑删除] │ │ │
│ │ │ 知识提取     │ Claude 3.5   │ GPT-4o       │ [编辑删除] │ │ │
│ │ │ 图片分析     │ Gemini 2.0   │ GPT-4o       │ [编辑删除] │ │ │
│ │ │ 文档解析     │ GPT-4o Mini  │ Claude Haiku │ [编辑删除] │ │ │
│ │ └──────────────┴──────────────┴──────────────┴────────────┘ │ │
│ │                                                             │ │
│ │ [+ 添加任务类型映射]                                         │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ 负载均衡配置                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ☑ 启用负载均衡                                               │ │
│ │                                                             │ │
│ │ 负载阈值: [滑块] 80%                                         │ │
│ │ 当模型负载超过阈值时，自动切换到备用模型                      │ │
│ │                                                             │ │
│ │ 重试策略:                                                    │ │
│ │ • 最大重试次数: [输入框] 3                                   │ │
│ │ • 重试间隔(秒): [输入框] 2                                   │ │
│ │ • 失败后切换模型: ☑                                          │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ [保存配置] [恢复默认]                                            │
└─────────────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **默认调度策略**：
   - 质量优先：选择效果最好的模型（根据历史表现）
   - 平衡选择：综合质量、速度、成本评分
   - 速度优先：选择响应最快的模型
   - 成本优先：选择成本最低的模型

2. **任务类型映射**：
   - 为不同任务类型指定首选和备用模型
   - 支持添加自定义任务类型
   - 首选模型不可用时自动切换到备用模型

3. **负载均衡**：
   - 监控模型负载，超过阈值自动切换
   - 配置重试策略和失败处理

#### 3.4.5 Tab3: 性能监控

**功能说明**：实时监控模型性能指标

```
┌─────────────────────────────────────────────────────────────────┐
│ 性能监控                    时间范围: [最近24小时 ▼]             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ 关键指标概览                                                     │
│ ┌──────────────┬──────────────┬──────────────┬──────────────┐  │
│ │ 总请求数     │ 成功率       │ 平均响应时间 │ 总成本       │  │
│ │ 12,458       │ 98.5%        │ 2.1s         │ $45.32       │  │
│ └──────────────┴──────────────┴──────────────┴──────────────┘  │
│                                                                 │
│ 模型性能对比                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ [折线图 - 响应时间趋势]                                      │ │
│ │                                                             │ │
│ │   3.5s ┤                                                    │ │
│ │   3.0s ┤                                                    │ │
│ │   2.5s ┤        ╱╲                                          │ │
│ │   2.0s ┤   ╱╲  ╱  ╲    ╱╲                                  │ │
│ │   1.5s ┤  ╱  ╲╱    ╲  ╱  ╲                                 │ │
│ │   1.0s ┤ ╱          ╲╱    ╲                                │ │
│ │        └─────────────────────────────────────────────────   │ │
│ │         0h  4h  8h  12h 16h 20h 24h                         │ │
│ │                                                             │ │
│ │ 图例: ─ GPT-4o  ─ Claude 3.5  ─ Gemini 2.0                 │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ 模型详细统计                                                     │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ┌────────┬────────┬────────┬────────┬────────┬──────────┐  │ │
│ │ │ 模型   │ 请求数 │ 成功率 │ 平均响应│ Token  │ 成本     │  │ │
│ │ ├────────┼────────┼────────┼────────┼────────┼──────────┤  │ │
│ │ │ GPT-4o │ 5,234  │ 99.2%  │ 2.3s   │ 1.2M   │ $18.45   │  │ │
│ │ │ Claude │ 4,567  │ 98.8%  │ 1.8s   │ 980K   │ $15.23   │  │ │
│ │ │ Gemini │ 2,657  │ 95.5%  │ 3.1s   │ 650K   │ $11.64   │  │ │
│ │ └────────┴────────┴────────┴────────┴────────┴──────────┘  │ │
│ │                                                             │ │
│ │ [导出报告] [查看详情]                                        │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│ 告警记录                                                         │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ ⚠️ 2026-02-08 14:23 - Gemini 2.0 成功率低于95%              │ │
│ │ ⚠️ 2026-02-08 12:15 - GPT-4o 响应时间超过5秒                │ │
│ │ ℹ️ 2026-02-08 10:30 - Claude 3.5 已自动切换到备用端点       │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**交互说明**：

1. **关键指标概览**：
   - 总请求数、成功率、平均响应时间、总成本
   - 实时更新，支持不同时间范围查看

2. **性能对比图表**：
   - 折线图展示多个模型的响应时间趋势
   - 支持切换指标（响应时间、成功率、成本）
   - 支持缩放和时间范围选择

3. **模型详细统计**：
   - 表格形式展示各模型的详细指标
   - 支持排序和筛选
   - 支持导出为CSV/Excel

4. **告警记录**：
   - 显示最近的异常和告警
   - 按严重程度分类（错误、警告、信息）
   - 点击查看详细日志

---

## 4. 交互规范

### 4.1 通用交互模式

#### 4.1.1 加载状态

**全局加载**：
- 使用Spin组件，居中显示
- 显示加载文案："加载中..."
- 超过3秒显示进度提示

**局部加载**：
- 使用Skeleton骨架屏
- 保持布局稳定，避免闪烁
- 数据加载完成后平滑过渡

**长时间操作**：
- 显示进度条（Progress组件）
- 显示当前步骤和预计剩余时间
- 支持取消操作

#### 4.1.2 操作反馈

**成功反馈**：
- 使用Message.success提示
- 显示时间：3秒
- 文案简洁明确："保存成功"、"删除成功"

**错误反馈**：
- 使用Message.error提示
- 显示时间：5秒
- 文案包含错误原因和建议操作
- 示例："保存失败：网络连接超时，请检查网络后重试"

**警告反馈**：
- 使用Message.warning提示
- 显示时间：4秒
- 文案说明潜在风险
- 示例："该操作将影响3个场景模板，请谨慎操作"

**确认对话框**：
- 使用Modal.confirm
- 标题明确操作内容
- 内容说明影响范围
- 提供"确认"和"取消"按钮
- 危险操作使用红色按钮

#### 4.1.3 表单验证

**实时验证**：
- 失焦时验证（onBlur）
- 显示错误提示在输入框下方
- 错误状态：红色边框 + 错误图标

**提交验证**：
- 点击提交时验证所有字段
- 滚动到第一个错误字段
- 聚焦到错误输入框

**验证规则**：
- 必填项：显示红色星号 *
- 格式验证：邮箱、URL、数字等
- 自定义验证：本体名称唯一性、关系有效性

#### 4.1.4 数据操作

**创建操作**：
1. 点击"新建"按钮
2. 打开表单对话框或跳转到编辑页
3. 填写必填信息
4. 点击"保存"提交
5. 成功后关闭对话框并刷新列表

**编辑操作**：
1. 点击"编辑"按钮
2. 加载现有数据到表单
3. 修改字段
4. 点击"保存"提交
5. 成功后更新显示

**删除操作**：
1. 点击"删除"按钮
2. 弹出确认对话框
3. 显示删除影响范围
4. 确认后执行删除
5. 成功后从列表中移除

**批量操作**：
- 支持多选（Checkbox）
- 显示已选数量
- 提供批量操作按钮
- 确认对话框显示影响范围

### 4.2 快捷键支持

| 快捷键 | 功能 | 适用场景 |
|-------|------|---------|
| Ctrl + S | 保存 | 编辑器、表单 |
| Ctrl + Z | 撤销 | 编辑器 |
| Ctrl + Y | 重做 | 编辑器 |
| Ctrl + F | 搜索 | 列表、编辑器 |
| Esc | 关闭对话框 | 所有对话框 |
| Enter | 确认 | 对话框、表单 |
| Delete | 删除选中项 | 列表、画布 |
| Ctrl + A | 全选 | 列表、画布 |

### 4.3 错误处理

#### 4.3.1 网络错误

**连接超时**：
- 提示："网络连接超时，请检查网络后重试"
- 提供"重试"按钮
- 记录错误日志

**服务器错误（5xx）**：
- 提示："服务器异常，请稍后重试"
- 提供错误码和请求ID
- 支持复制错误信息

**客户端错误（4xx）**：
- 400：提示具体的参数错误
- 401：跳转到登录页
- 403：提示权限不足
- 404：提示资源不存在

#### 4.3.2 业务错误

**数据验证失败**：
- 高亮错误字段
- 显示具体错误原因
- 提供修改建议

**操作冲突**：
- 提示："该资源正在被其他用户编辑"
- 提供"查看最新版本"选项
- 支持强制覆盖（需确认）

**依赖检查失败**：
- 提示："无法删除，该本体被3个知识实例引用"
- 显示依赖列表
- 提供"查看依赖"链接

### 4.4 无障碍支持

**键盘导航**：
- 所有交互元素支持Tab键导航
- 焦点状态清晰可见
- 支持快捷键操作

**屏幕阅读器**：
- 所有图标提供aria-label
- 表单字段关联label
- 动态内容更新通知

**颜色对比度**：
- 文字与背景对比度 ≥ 4.5:1
- 重要信息不仅依赖颜色区分
- 支持高对比度模式

---

## 5. 视觉规范

### 5.1 色彩系统

#### 5.1.1 主色调

**品牌色**：
- 主色：#1890ff（Ant Design Blue）
- 用于：主要按钮、链接、选中状态

**功能色**：
- 成功：#52c41a（绿色）
- 警告：#faad14（橙色）
- 错误：#f5222d（红色）
- 信息：#1890ff（蓝色）

#### 5.1.2 中性色

**文字颜色**：
- 标题/重要文字：rgba(0, 0, 0, 0.85)
- 正文：rgba(0, 0, 0, 0.65)
- 次要信息：rgba(0, 0, 0, 0.45)
- 禁用状态：rgba(0, 0, 0, 0.25)

**背景颜色**：
- 页面背景：#f0f2f5
- 组件背景：#ffffff
- 悬停背景：#fafafa
- 选中背景：#e6f7ff

**边框颜色**：
- 默认边框：#d9d9d9
- 分割线：#f0f0f0
- 深色边框：#bfbfbf

#### 5.1.3 本体类型配色

为不同本体类型分配专属颜色，便于识别：

| 本体类型 | 颜色 | 色值 |
|---------|------|------|
| Entity | 蓝色 | #1890ff |
| Event | 绿色 | #52c41a |
| State | 橙色 | #fa8c16 |
| Observable | 紫色 | #722ed1 |
| Rule | 红色 | #f5222d |
| ModelConcept | 青色 | #13c2c2 |

### 5.2 字体规范

#### 5.2.1 字体家族

**中文字体**：
```css
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
             'Helvetica Neue', Arial, 'Noto Sans', sans-serif,
             'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
             'Noto Color Emoji';
```

**代码字体**（编辑器）：
```css
font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
```

#### 5.2.2 字体大小

| 用途 | 字号 | 行高 | 字重 |
|-----|------|------|------|
| 页面标题 | 24px | 32px | 600 |
| 模块标题 | 20px | 28px | 600 |
| 卡片标题 | 16px | 24px | 500 |
| 正文 | 14px | 22px | 400 |
| 辅助文字 | 12px | 20px | 400 |
| 小字 | 12px | 20px | 400 |

### 5.3 间距系统

采用8px基准间距系统：

| 间距名称 | 数值 | 用途 |
|---------|------|------|
| xs | 4px | 极小间距 |
| sm | 8px | 小间距 |
| md | 16px | 中等间距（默认） |
| lg | 24px | 大间距 |
| xl | 32px | 超大间距 |
| xxl | 48px | 特大间距 |

**应用场景**：
- 组件内部间距：8px、16px
- 组件之间间距：16px、24px
- 模块之间间距：24px、32px
- 页面边距：24px

### 5.4 圆角规范

| 元素类型 | 圆角值 |
|---------|--------|
| 按钮 | 2px |
| 输入框 | 2px |
| 卡片 | 8px |
| 对话框 | 8px |
| 标签 | 2px |
| 图形节点 | 4px |

### 5.5 阴影规范

**卡片阴影**：
```css
box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
```

**悬停阴影**：
```css
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
```

**对话框阴影**：
```css
box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
```

### 5.6 图标规范

**图标库**：使用Ant Design Icons

**图标大小**：
- 小图标：14px
- 默认图标：16px
- 大图标：20px
- 特大图标：24px

**图标颜色**：
- 默认：rgba(0, 0, 0, 0.65)
- 悬停：rgba(0, 0, 0, 0.85)
- 禁用：rgba(0, 0, 0, 0.25)

**常用图标映射**：
- 本体：DeploymentUnitOutlined
- 知识库：DatabaseOutlined
- 提示词：FileTextOutlined
- 模型：ApiOutlined
- 编辑：EditOutlined
- 删除：DeleteOutlined
- 添加：PlusOutlined
- 搜索：SearchOutlined
- 设置：SettingOutlined

---

## 6. 技术实现建议

### 6.1 技术栈推荐

#### 6.1.1 前端框架

**React 18+**：
- 理由：生态成熟、组件化开发、性能优秀
- 配合TypeScript提供类型安全

**构建工具**：
- Vite：快速的开发服务器和构建工具
- 或 Create React App（稳定但较慢）

#### 6.1.2 UI组件库

**Ant Design 5.x**：
- 理由：企业级UI设计、组件丰富、文档完善
- 符合现有Demo的设计风格
- 提供完整的表单、表格、布局组件

**补充组件**：
- @ant-design/pro-components：高级业务组件
- @ant-design/charts：图表组件

#### 6.1.3 状态管理

**推荐方案**：
- Zustand：轻量级、易用、TypeScript友好
- 或 Redux Toolkit：功能强大、生态完善

**状态分层**：
- 全局状态：用户信息、系统配置
- 模块状态：本体列表、知识图谱数据
- 组件状态：表单数据、UI状态

#### 6.1.4 路由管理

**React Router v6**：
- 声明式路由配置
- 支持嵌套路由
- 代码分割和懒加载

### 6.2 核心功能实现

#### 6.2.1 图可视化

**推荐库**：

**方案1：Neo4j Bloom集成**（推荐）：
- 直接集成Neo4j官方可视化工具
- 功能完整、性能优秀
- 开源版本可用

**方案2：自研图可视化**：
- 基础库：D3.js 或 G6（AntV）
- G6优势：国产、文档中文、与Ant Design配套
- 支持力导向布局、自定义节点样式

**实现要点**：
```typescript
// 使用G6的示例代码结构
import G6 from '@antv/g6';

const graph = new G6.Graph({
  container: 'container',
  width: 800,
  height: 600,
  layout: {
    type: 'force',
    preventOverlap: true,
  },
  modes: {
    default: ['drag-canvas', 'zoom-canvas', 'drag-node'],
  },
});

// 加载数据
graph.data(graphData);
graph.render();
```

#### 6.2.2 代码编辑器

**Monaco Editor**（VS Code同款）：
- 功能强大：语法高亮、自动补全、代码格式化
- 支持多种语言：Markdown、JSON、Cypher
- React封装：@monaco-editor/react

**实现要点**：
```typescript
import Editor from '@monaco-editor/react';

<Editor
  height="400px"
  language="markdown"
  theme="vs-dark"
  value={promptContent}
  onChange={handleEditorChange}
  options={{
    minimap: { enabled: false },
    fontSize: 14,
    wordWrap: 'on',
  }}
/>
```

#### 6.2.3 表单管理

**Ant Design Form + React Hook Form**：
- Ant Design Form：UI层
- React Hook Form：状态管理和验证
- 结合使用获得最佳体验

**实现要点**：
```typescript
import { useForm, Controller } from 'react-hook-form';
import { Form, Input } from 'antd';

const { control, handleSubmit } = useForm();

<Form onFinish={handleSubmit(onSubmit)}>
  <Controller
    name="ontologyName"
    control={control}
    rules={{ required: '本体名称不能为空' }}
    render={({ field, fieldState }) => (
      <Form.Item
        label="本体名称"
        validateStatus={fieldState.error ? 'error' : ''}
        help={fieldState.error?.message}
      >
        <Input {...field} />
      </Form.Item>
    )}
  />
</Form>
```

### 6.3 API设计建议

#### 6.3.1 RESTful API规范

**基础路径**：`/api/v1`

**本体管理API**：
```
GET    /api/v1/ontologies          # 获取本体列表
POST   /api/v1/ontologies          # 创建本体
GET    /api/v1/ontologies/:id      # 获取本体详情
PUT    /api/v1/ontologies/:id      # 更新本体
DELETE /api/v1/ontologies/:id      # 删除本体
GET    /api/v1/ontologies/:id/graph # 获取本体关系图
```

**知识图谱API**：
```
GET    /api/v1/knowledge/nodes     # 获取节点列表
POST   /api/v1/knowledge/nodes     # 创建节点
GET    /api/v1/knowledge/graph     # 获取知识图谱
POST   /api/v1/knowledge/query     # Cypher查询
POST   /api/v1/knowledge/ai-generate # AI生成知识
```

**提示词管理API**：
```
GET    /api/v1/prompts             # 获取提示词列表
POST   /api/v1/prompts             # 创建提示词
PUT    /api/v1/prompts/:id         # 更新提示词
POST   /api/v1/prompts/:id/test    # 测试提示词
GET    /api/v1/prompts/:id/versions # 获取版本历史
```

**模型管理API**：
```
GET    /api/v1/models              # 获取模型列表
POST   /api/v1/models              # 添加模型
PUT    /api/v1/models/:id          # 更新模型配置
POST   /api/v1/models/:id/test     # 测试模型连接
GET    /api/v1/models/metrics      # 获取性能指标
```

#### 6.3.2 请求/响应格式

**统一响应格式**：
```typescript
interface ApiResponse<T> {
  code: number;        // 状态码：0成功，其他失败
  message: string;     // 提示信息
  data: T;            // 响应数据
  timestamp: number;   // 时间戳
}
```

**分页响应格式**：
```typescript
interface PageResponse<T> {
  items: T[];          // 数据列表
  total: number;       // 总数
  page: number;        // 当前页
  pageSize: number;    // 每页数量
}
```

### 6.4 性能优化建议

#### 6.4.1 代码分割

**路由级别分割**：
```typescript
import { lazy, Suspense } from 'react';

const OntologyManager = lazy(() => import('./pages/OntologyManager'));
const KnowledgeGraph = lazy(() => import('./pages/KnowledgeGraph'));

<Suspense fallback={<Spin />}>
  <Routes>
    <Route path="/ontology" element={<OntologyManager />} />
    <Route path="/knowledge" element={<KnowledgeGraph />} />
  </Routes>
</Suspense>
```

#### 6.4.2 数据缓存

**React Query**（推荐）：
- 自动缓存和重新验证
- 后台数据同步
- 乐观更新

```typescript
import { useQuery } from '@tanstack/react-query';

const { data, isLoading } = useQuery({
  queryKey: ['ontologies'],
  queryFn: fetchOntologies,
  staleTime: 5 * 60 * 1000, // 5分钟
});
```

#### 6.4.3 虚拟滚动

**大列表优化**：
- 使用react-window或react-virtualized
- 只渲染可见区域的元素

#### 6.4.4 图形性能优化

**知识图谱优化**：
- 节点数量 > 1000时启用聚合
- 使用WebGL渲染（G6支持）
- 按需加载节点（展开时加载）

### 6.5 开发工具建议

**代码质量**：
- ESLint：代码规范检查
- Prettier：代码格式化
- Husky：Git hooks

**类型检查**：
- TypeScript：静态类型检查
- 严格模式：strict: true

**测试工具**：
- Jest：单元测试
- React Testing Library：组件测试
- Cypress：E2E测试

### 6.6 部署建议

**容器化部署**：
- Docker：容器化前端应用
- Nginx：静态资源服务器

**CDN加速**：
- 静态资源上传到CDN
- 图片使用WebP格式

**监控告警**：
- Sentry：错误监控
- Google Analytics：用户行为分析

---

## 附录

### A. 参考资源

**设计参考**：
- Neo4j Bloom：https://neo4j.com/product/bloom/
- Apifox：https://www.apifox.cn/
- Ant Design：https://ant.design/

**技术文档**：
- React：https://react.dev/
- Ant Design：https://ant.design/docs/react/introduce-cn
- G6：https://g6.antv.antgroup.com/
- Monaco Editor：https://microsoft.github.io/monaco-editor/

### B. 版本历史

| 版本 | 日期 | 修改内容 | 作者 |
|-----|------|---------|------|
| v2.0 | 2026-02-08 | 创建P0阶段交互需求设计文档 | Claude |

### C. 待确认事项

1. **Neo4j Bloom集成方式**：是否直接集成开源版本，还是自研图可视化？
2. **代码编辑器主题**：使用浅色还是深色主题？
3. **图形节点样式**：是否需要自定义节点渲染器？
4. **性能指标阈值**：具体的性能要求（如节点数量上限）？

---

**文档结束**

> **下一步行动**：
> 1. 评审本交互需求设计文档
> 2. 确认待确认事项
> 3. 开始前端开发实施
> 4. 与后端API设计对齐

